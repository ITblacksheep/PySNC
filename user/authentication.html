
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Authentication &#8212; PySNC 1.0.7 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="The API" href="../api.html" />
    <link rel="prev" title="Advanced" href="advanced.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="authentication">
<span id="id1"></span><h1>Authentication<a class="headerlink" href="#authentication" title="Permalink to this heading">¶</a></h1>
<section id="basic-authentication">
<h2>Basic Authentication<a class="headerlink" href="#basic-authentication" title="Permalink to this heading">¶</a></h2>
<p>Standard BasicAuth, every request contains your username and password base64 encoded in the request header. The most
insecure, but simplest, way to authenticate. Remember to scope the user’s ACLs to the minimum if using with automations.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">client</span> <span class="o">=</span> <span class="n">pysnc</span><span class="o">.</span><span class="n">ServiceNowClient</span><span class="p">(</span><span class="s1">&#39;dev00000&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;admin&#39;</span><span class="p">,</span><span class="s1">&#39;password&#39;</span><span class="p">))</span>
</pre></div>
</div>
</section>
<section id="oauth-authentication">
<h2>OAuth Authentication<a class="headerlink" href="#oauth-authentication" title="Permalink to this heading">¶</a></h2>
<p>OAuth2 password flow is currently supported and recommended - one must setup an OAuth Client to use.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnc</span> <span class="kn">import</span> <span class="n">ServiceNowClient</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnc.auth</span> <span class="kn">import</span> <span class="n">ServiceNowOauth2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">client_id</span> <span class="o">=</span> <span class="s1">&#39;ac0dd3408c1031006907010c2cc6ef6d&#39;</span> <span class="c1"># oauth_entity.client_id</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">secret</span> <span class="o">=</span> <span class="s1">&#39;...&#39;</span> <span class="c1"># oauth_entity.client_secret</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">client</span> <span class="o">=</span> <span class="n">ServiceNowClient</span><span class="p">(</span><span class="n">server_url</span><span class="p">,</span> <span class="n">ServiceNowOAuth2</span><span class="p">(</span><span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="p">,</span> <span class="n">client_id</span><span class="p">,</span> <span class="n">secret</span><span class="p">))</span>
</pre></div>
</div>
<p>This will use a users credentials to retrieve and store an OAuth2 auth and refresh token, sending your auth token with
every request and dropping your user and password from memory. If this sleeps for a long enough time your refresh token
may requiring re-auth.</p>
</section>
<section id="jwt-authentication">
<h2>JWT Authentication<a class="headerlink" href="#jwt-authentication" title="Permalink to this heading">¶</a></h2>
<p>Create a new [JWT Provider](<a class="reference external" href="https://docs.servicenow.com/en-US/bundle/tokyo-platform-security/page/administer/security/task/create-jwt-endpoint.html">https://docs.servicenow.com/en-US/bundle/tokyo-platform-security/page/administer/security/task/create-jwt-endpoint.html</a>)
and use it with whomever generates your JWT tokens. Once you have your JWT you may use it to request a Bearer token for
standard auth:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">auth</span> <span class="o">=</span> <span class="n">ServiceNowJWTAuth</span><span class="p">(</span><span class="n">client_id</span><span class="p">,</span> <span class="n">client_secret</span><span class="p">,</span> <span class="n">token</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">client</span> <span class="o">=</span> <span class="n">ServiceNowClient</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">server</span><span class="p">,</span> <span class="n">auth</span><span class="p">)</span>
</pre></div>
</div>
<p>Wherein client_id and client_secret are the <cite>oauth_jwt</cite> record entry values and <cite>token</cite> is the JWT generated by your provider.</p>
<p>The token contains who are are logging in as - as such the PySNC library does not attempt to act as a provider. We do however
have an example of how that is done in the tests.</p>
</section>
<section id="requests-authentication">
<h2>Requests Authentication<a class="headerlink" href="#requests-authentication" title="Permalink to this heading">¶</a></h2>
<p>Ultimately any authentication method supported by python requests (<a class="reference external" href="https://2.python-requests.org/en/master/user/authentication/">https://2.python-requests.org/en/master/user/authentication/</a>) can be passed directly to ServiceNowClient.</p>
<p>Should be flexible enough for any use-case.</p>
</section>
<section id="storing-passwords">
<h2>Storing Passwords<a class="headerlink" href="#storing-passwords" title="Permalink to this heading">¶</a></h2>
<p>The keystore module is highly recommended. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">keyring</span>

<span class="k">def</span> <span class="nf">check_keyring</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span> <span class="n">user</span><span class="p">):</span>
    <span class="n">passw</span> <span class="o">=</span> <span class="n">keyring</span><span class="o">.</span><span class="n">get_password</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span> <span class="n">user</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">passw</span>

<span class="k">def</span> <span class="nf">set_keyring</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span> <span class="n">user</span><span class="p">,</span> <span class="n">passw</span><span class="p">):</span>
    <span class="n">keyring</span><span class="o">.</span><span class="n">set_password</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span> <span class="n">user</span><span class="p">,</span> <span class="n">passw</span><span class="p">)</span>

<span class="k">if</span> <span class="n">options</span><span class="o">.</span><span class="n">password</span><span class="p">:</span>
    <span class="n">passw</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">password</span>
    <span class="n">set_keyring</span><span class="p">(</span><span class="n">options</span><span class="o">.</span><span class="n">instance</span><span class="p">,</span> <span class="n">options</span><span class="o">.</span><span class="n">user</span><span class="p">,</span> <span class="n">passw</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">passw</span> <span class="o">=</span> <span class="n">check_keyring</span><span class="p">(</span><span class="n">options</span><span class="o">.</span><span class="n">instance</span><span class="p">,</span> <span class="n">options</span><span class="o">.</span><span class="n">user</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">passw</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;No Password specified and none found in keyring&#39;</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="n">client</span> <span class="o">=</span> <span class="n">pysnc</span><span class="o">.</span><span class="n">ServiceNowClient</span><span class="p">(</span><span class="n">options</span><span class="o">.</span><span class="n">instance</span><span class="p">,</span> <span class="n">ServiceNowOAuth2</span><span class="p">(</span><span class="n">options</span><span class="o">.</span><span class="n">user</span><span class="p">,</span> <span class="n">passw</span><span class="p">))</span>
</pre></div>
</div>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">PySNC</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation of PySNC</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="advanced.html">Advanced</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Authentication</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#basic-authentication">Basic Authentication</a></li>
<li class="toctree-l2"><a class="reference internal" href="#oauth-authentication">OAuth Authentication</a></li>
<li class="toctree-l2"><a class="reference internal" href="#jwt-authentication">JWT Authentication</a></li>
<li class="toctree-l2"><a class="reference internal" href="#requests-authentication">Requests Authentication</a></li>
<li class="toctree-l2"><a class="reference internal" href="#storing-passwords">Storing Passwords</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api.html">The API</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
      <li>Previous: <a href="advanced.html" title="previous chapter">Advanced</a></li>
      <li>Next: <a href="../api.html" title="next chapter">The API</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2018, Matthew Gill.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 5.2.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/user/authentication.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>